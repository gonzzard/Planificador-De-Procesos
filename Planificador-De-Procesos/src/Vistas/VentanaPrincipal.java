package Vistas;

import Algoritmos.Algoritmo;
import Utils.Constantes;
import Algoritmos.Implementacion.FIFS;
import Procesos.Proceso;
import java.awt.Color;
import java.awt.Dimension;
import java.awt.Graphics2D;
import java.awt.Point;
import java.awt.image.BufferedImage;
import java.awt.image.ColorModel;
import java.awt.image.WritableRaster;
import java.util.ArrayList;
import java.util.Iterator;
import java.util.List;
import static javax.swing.ScrollPaneConstants.HORIZONTAL_SCROLLBAR_NEVER;
import javax.swing.SwingUtilities;
import javax.swing.table.DefaultTableModel;

/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
/**
 *
 * @author Gonzalo
 */
public class VentanaPrincipal extends javax.swing.JFrame
{
    private int idProceso;

    protected List<Proceso> procesos;

    private Boolean FIFS;

    private Algoritmo algoritmo;

    public DefaultTableModel model, modelCola;

    public BufferedImage bufferPanelGantt, vacio;
    
    protected Graphics2D graficaPanel, graficaBuffer;

    /**
     * Creates new form NewJFrame
     */
    public VentanaPrincipal()
    {
        // Inicialización de los componentes del frame
        initComponents();
        
        // Inicialización de procesos
        this.idProceso = 1;
        this.procesos = new ArrayList<>();

        // Inicialización de los modelos de las tablas
        this.model = (DefaultTableModel) tablaProcesos.getModel();
        this.modelCola = (DefaultTableModel) tablaProcesos.getModel();

        // Inicialización de botones
        this.btnListo.setEnabled(false);
        this.btnPasoSiguiente.setEnabled(false);
        this.btnSimular.setEnabled(false);
        
        int ancho = panelGantt.getWidth();
        int alto = panelGantt.getHeight();

        bufferPanelGantt = (BufferedImage) panelGantt.createImage(ancho, alto);
        vacio = copiarBuffer(bufferPanelGantt);
        Graphics2D g3 = bufferPanelGantt.createGraphics();
        g3.setColor(Color.white);
        g3.fillRect(0, 0, ancho, alto);
        graficaPanel = (Graphics2D) panelGantt.getGraphics();
        graficaBuffer = (Graphics2D) bufferPanelGantt.getGraphics();
        
        graficaPanel.drawImage(bufferPanelGantt, 0, 0, null);
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents()
    {

        panelGantt = new javax.swing.JPanel();
        jPanel1 = new javax.swing.JPanel();
        btnSimular = new javax.swing.JButton();
        btnAniadirProceso = new javax.swing.JButton();
        chxFIFS = new javax.swing.JCheckBox();
        chxSJF = new javax.swing.JCheckBox();
        chxRR = new javax.swing.JCheckBox();
        btnPasoSiguiente = new javax.swing.JButton();
        btnListo = new javax.swing.JButton();
        jScrollPane1 = new javax.swing.JScrollPane();
        tablaProcesos = new javax.swing.JTable();
        spColaProcesosListos = new javax.swing.JScrollPane();
        tblColaProcesosListos = new javax.swing.JTable();
        jScrollPane2 = new javax.swing.JScrollPane();
        jTable1 = new javax.swing.JTable();
        jScrollPane3 = new javax.swing.JScrollPane();
        jTable2 = new javax.swing.JTable();
        jLabel1 = new javax.swing.JLabel();
        jLabel2 = new javax.swing.JLabel();
        jLabel3 = new javax.swing.JLabel();
        jLabel4 = new javax.swing.JLabel();
        jLabel5 = new javax.swing.JLabel();
        jLabel6 = new javax.swing.JLabel();

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);
        setTitle("Simulador planificador de procesos");
        setMaximumSize(new java.awt.Dimension(99999, 99999));
        setMinimumSize(new java.awt.Dimension(1060, 620));
        setPreferredSize(new java.awt.Dimension(1060, 620));
        setResizable(false);
        getContentPane().setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        panelGantt.setBackground(new java.awt.Color(255, 255, 255));
        panelGantt.setMaximumSize(new java.awt.Dimension(1005, 150));
        panelGantt.setMinimumSize(new java.awt.Dimension(1005, 150));
        panelGantt.setPreferredSize(new java.awt.Dimension(1020, 150));
        panelGantt.addContainerListener(new java.awt.event.ContainerAdapter()
        {
            public void componentAdded(java.awt.event.ContainerEvent evt)
            {
                panelGanttComponentAdded(evt);
            }
        });
        panelGantt.addComponentListener(new java.awt.event.ComponentAdapter()
        {
            public void componentShown(java.awt.event.ComponentEvent evt)
            {
                panelGanttComponentShown(evt);
            }
        });

        javax.swing.GroupLayout panelGanttLayout = new javax.swing.GroupLayout(panelGantt);
        panelGantt.setLayout(panelGanttLayout);
        panelGanttLayout.setHorizontalGroup(
            panelGanttLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 1040, Short.MAX_VALUE)
        );
        panelGanttLayout.setVerticalGroup(
            panelGanttLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 240, Short.MAX_VALUE)
        );

        getContentPane().add(panelGantt, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 350, 1040, 240));
        panelGantt.getAccessibleContext().setAccessibleName("");

        jPanel1.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(153, 153, 153)));

        btnSimular.setText("Simular");
        btnSimular.setMaximumSize(new java.awt.Dimension(138, 29));
        btnSimular.setMinimumSize(new java.awt.Dimension(138, 29));
        btnSimular.addMouseListener(new java.awt.event.MouseAdapter()
        {
            public void mousePressed(java.awt.event.MouseEvent evt)
            {
                btnSimularMousePressed(evt);
            }
        });

        btnAniadirProceso.setText("Añadir Proceso");
        btnAniadirProceso.addMouseListener(new java.awt.event.MouseAdapter()
        {
            public void mousePressed(java.awt.event.MouseEvent evt)
            {
                btnAniadirProcesoMousePressed(evt);
            }
        });

        chxFIFS.setText("FIFS");
        chxFIFS.addMouseListener(new java.awt.event.MouseAdapter()
        {
            public void mousePressed(java.awt.event.MouseEvent evt)
            {
                chxFIFSMousePressed(evt);
            }
        });

        chxSJF.setText("SJF");
        chxSJF.addMouseListener(new java.awt.event.MouseAdapter()
        {
            public void mousePressed(java.awt.event.MouseEvent evt)
            {
                chxSJFMousePressed(evt);
            }
        });

        chxRR.setText("RR");
        chxRR.addMouseListener(new java.awt.event.MouseAdapter()
        {
            public void mousePressed(java.awt.event.MouseEvent evt)
            {
                chxRRMousePressed(evt);
            }
        });

        btnPasoSiguiente.setText("Paso Siguiente");
        btnPasoSiguiente.addMouseListener(new java.awt.event.MouseAdapter()
        {
            public void mousePressed(java.awt.event.MouseEvent evt)
            {
                btnPasoSiguienteMousePressed(evt);
            }
        });

        btnListo.setText("Listo");
        btnListo.addActionListener(new java.awt.event.ActionListener()
        {
            public void actionPerformed(java.awt.event.ActionEvent evt)
            {
                btnListoActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
        jPanel1.setLayout(jPanel1Layout);
        jPanel1Layout.setHorizontalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addComponent(chxFIFS)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(chxSJF))
                    .addComponent(btnSimular, javax.swing.GroupLayout.PREFERRED_SIZE, 123, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(btnAniadirProceso, javax.swing.GroupLayout.PREFERRED_SIZE, 126, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(btnListo)
                    .addComponent(btnPasoSiguiente, javax.swing.GroupLayout.PREFERRED_SIZE, 150, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(chxRR))
                .addContainerGap(180, Short.MAX_VALUE))
        );
        jPanel1Layout.setVerticalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(btnAniadirProceso)
                    .addComponent(btnListo))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(chxFIFS)
                    .addComponent(chxSJF)
                    .addComponent(chxRR))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(btnPasoSiguiente)
                    .addComponent(btnSimular, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(49, 49, 49))
        );

        getContentPane().add(jPanel1, new org.netbeans.lib.awtextra.AbsoluteConstraints(580, 40, 470, 106));

        jScrollPane1.setPreferredSize(new java.awt.Dimension(454, 404));

        tablaProcesos.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][]
            {

            },
            new String []
            {
                "Id", "Llegada", "CPU1", "E/S", "CPU2", "Prioridad", "Progreso"
            }
        )
        {
            Class[] types = new Class []
            {
                java.lang.Integer.class, java.lang.Integer.class, java.lang.Integer.class, java.lang.Integer.class, java.lang.Integer.class, java.lang.Integer.class, java.lang.String.class
            };
            boolean[] canEdit = new boolean []
            {
                false, true, true, true, true, true, false
            };

            public Class getColumnClass(int columnIndex)
            {
                return types [columnIndex];
            }

            public boolean isCellEditable(int rowIndex, int columnIndex)
            {
                return canEdit [columnIndex];
            }
        });
        tablaProcesos.setToolTipText("");
        tablaProcesos.setAutoResizeMode(javax.swing.JTable.AUTO_RESIZE_OFF);
        tablaProcesos.setShowGrid(true);
        tablaProcesos.getTableHeader().setReorderingAllowed(false);
        jScrollPane1.setViewportView(tablaProcesos);
        if (tablaProcesos.getColumnModel().getColumnCount() > 0)
        {
            tablaProcesos.getColumnModel().getColumn(0).setResizable(false);
            tablaProcesos.getColumnModel().getColumn(1).setResizable(false);
            tablaProcesos.getColumnModel().getColumn(2).setResizable(false);
            tablaProcesos.getColumnModel().getColumn(3).setResizable(false);
            tablaProcesos.getColumnModel().getColumn(4).setResizable(false);
            tablaProcesos.getColumnModel().getColumn(5).setResizable(false);
            tablaProcesos.getColumnModel().getColumn(6).setResizable(false);
        }

        getContentPane().add(jScrollPane1, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 40, 531, 107));

        spColaProcesosListos.setPreferredSize(new java.awt.Dimension(454, 404));

        tblColaProcesosListos.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][]
            {

            },
            new String []
            {
                "Posición", "Id", "CPU1", "E/S", "CPU2", "Prioridad"
            }
        )
        {
            Class[] types = new Class []
            {
                java.lang.Integer.class, java.lang.Integer.class, java.lang.Integer.class, java.lang.Integer.class, java.lang.Integer.class, java.lang.Integer.class
            };
            boolean[] canEdit = new boolean []
            {
                false, false, false, false, false, false
            };

            public Class getColumnClass(int columnIndex)
            {
                return types [columnIndex];
            }

            public boolean isCellEditable(int rowIndex, int columnIndex)
            {
                return canEdit [columnIndex];
            }
        });
        tblColaProcesosListos.setToolTipText("Cola");
        tblColaProcesosListos.setAutoResizeMode(javax.swing.JTable.AUTO_RESIZE_OFF);
        tblColaProcesosListos.setName("");
        tblColaProcesosListos.setSelectionBackground(new java.awt.Color(255, 255, 255));
        tblColaProcesosListos.setShowGrid(true);
        tblColaProcesosListos.getTableHeader().setReorderingAllowed(false);
        spColaProcesosListos.setViewportView(tblColaProcesosListos);
        Dimension d = tblColaProcesosListos.getPreferredSize();
        spColaProcesosListos.setPreferredSize(
            new Dimension(d.width,tblColaProcesosListos.getRowHeight()*5+1));
        if (tblColaProcesosListos.getColumnModel().getColumnCount() > 0)
        {
            tblColaProcesosListos.getColumnModel().getColumn(0).setResizable(false);
            tblColaProcesosListos.getColumnModel().getColumn(1).setResizable(false);
            tblColaProcesosListos.getColumnModel().getColumn(2).setResizable(false);
            tblColaProcesosListos.getColumnModel().getColumn(3).setResizable(false);
            tblColaProcesosListos.getColumnModel().getColumn(4).setResizable(false);
            tblColaProcesosListos.getColumnModel().getColumn(5).setResizable(false);
        }

        getContentPane().add(spColaProcesosListos, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 190, 450, 107));
        spColaProcesosListos.setHorizontalScrollBarPolicy(HORIZONTAL_SCROLLBAR_NEVER);

        jScrollPane2.setPreferredSize(new java.awt.Dimension(454, 107));

        jTable1.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][]
            {
                {null, null, null},
                {null, null, null},
                {null, null, null},
                {null, null, null}
            },
            new String []
            {
                "Id", "E/S", "E/S Restante"
            }
        )
        {
            Class[] types = new Class []
            {
                java.lang.Integer.class, java.lang.Integer.class, java.lang.Integer.class
            };
            boolean[] canEdit = new boolean []
            {
                false, false, false
            };

            public Class getColumnClass(int columnIndex)
            {
                return types [columnIndex];
            }

            public boolean isCellEditable(int rowIndex, int columnIndex)
            {
                return canEdit [columnIndex];
            }
        });
        jTable1.setMinimumSize(new java.awt.Dimension(90, 0));
        jTable1.setPreferredSize(new java.awt.Dimension(450, 0));
        jScrollPane2.setViewportView(jTable1);
        if (jTable1.getColumnModel().getColumnCount() > 0)
        {
            jTable1.getColumnModel().getColumn(1).setResizable(false);
        }
        Dimension d1 = jTable1.getPreferredSize();
        jScrollPane2.setPreferredSize(
            new Dimension(d1.width,jTable1.getRowHeight()*5+1));

        getContentPane().add(jScrollPane2, new org.netbeans.lib.awtextra.AbsoluteConstraints(520, 190, 290, 107));

        jTable2.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][]
            {

            },
            new String []
            {
                "Id", "Llegada"
            }
        )
        {
            Class[] types = new Class []
            {
                java.lang.Integer.class, java.lang.Integer.class
            };
            boolean[] canEdit = new boolean []
            {
                false, false
            };

            public Class getColumnClass(int columnIndex)
            {
                return types [columnIndex];
            }

            public boolean isCellEditable(int rowIndex, int columnIndex)
            {
                return canEdit [columnIndex];
            }
        });
        jScrollPane3.setViewportView(jTable2);
        if (jTable2.getColumnModel().getColumnCount() > 0)
        {
            jTable2.getColumnModel().getColumn(0).setResizable(false);
            jTable2.getColumnModel().getColumn(1).setResizable(false);
        }

        getContentPane().add(jScrollPane3, new org.netbeans.lib.awtextra.AbsoluteConstraints(870, 190, 180, 107));

        jLabel1.setFont(new java.awt.Font("Lucida Console", 0, 18)); // NOI18N
        jLabel1.setText("Cola de procesos");
        getContentPane().add(jLabel1, new org.netbeans.lib.awtextra.AbsoluteConstraints(180, 10, -1, -1));

        jLabel2.setFont(new java.awt.Font("Lucida Console", 0, 18)); // NOI18N
        jLabel2.setText("No llegados");
        getContentPane().add(jLabel2, new org.netbeans.lib.awtextra.AbsoluteConstraints(900, 160, -1, -1));

        jLabel3.setFont(new java.awt.Font("Lucida Console", 0, 18)); // NOI18N
        jLabel3.setText("Cola de listos");
        getContentPane().add(jLabel3, new org.netbeans.lib.awtextra.AbsoluteConstraints(160, 160, -1, -1));

        jLabel4.setFont(new java.awt.Font("Lucida Console", 0, 18)); // NOI18N
        jLabel4.setText("Cronograma");
        getContentPane().add(jLabel4, new org.netbeans.lib.awtextra.AbsoluteConstraints(470, 320, -1, -1));

        jLabel5.setFont(new java.awt.Font("Lucida Console", 0, 18)); // NOI18N
        jLabel5.setText("Panel de control");
        getContentPane().add(jLabel5, new org.netbeans.lib.awtextra.AbsoluteConstraints(740, 10, -1, -1));

        jLabel6.setFont(new java.awt.Font("Lucida Console", 0, 18)); // NOI18N
        jLabel6.setText("Cola de bloqueados");
        getContentPane().add(jLabel6, new org.netbeans.lib.awtextra.AbsoluteConstraints(570, 160, -1, -1));

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void btnAniadirProcesoMousePressed(java.awt.event.MouseEvent evt)//GEN-FIRST:event_btnAniadirProcesoMousePressed
    {//GEN-HEADEREND:event_btnAniadirProcesoMousePressed
        this.prepararDiagramaGantt();
        
        if (idProceso != 6)
        {
            model.addRow(new Object[]
        {
            idProceso, 0, 1, 0, 0, 1
        });
        idProceso++;
        btnListo.setEnabled(true);
        }
    }//GEN-LAST:event_btnAniadirProcesoMousePressed

    private void btnSimularMousePressed(java.awt.event.MouseEvent evt)//GEN-FIRST:event_btnSimularMousePressed
    {//GEN-HEADEREND:event_btnSimularMousePressed
        algoritmo.run(1);
        btnPasoSiguiente.setEnabled(false);
        btnSimular.setEnabled(false);
    }//GEN-LAST:event_btnSimularMousePressed

    private void btnPasoSiguienteMousePressed(java.awt.event.MouseEvent evt)//GEN-FIRST:event_btnPasoSiguienteMousePressed
    {//GEN-HEADEREND:event_btnPasoSiguienteMousePressed
        if (algoritmo.PasoSiguiente())
        {
            btnPasoSiguiente.setEnabled(false);
            btnSimular.setEnabled(false);
        }
    }//GEN-LAST:event_btnPasoSiguienteMousePressed

    private void btnListoActionPerformed(java.awt.event.ActionEvent evt)//GEN-FIRST:event_btnListoActionPerformed
    {//GEN-HEADEREND:event_btnListoActionPerformed
        btnAniadirProceso.setEnabled(false);
        btnListo.setEnabled(false);
        btnSimular.setEnabled(true);
        btnPasoSiguiente.setEnabled(true);
        tablaProcesos.setEnabled(false);
        tablaProcesos.setEnabled(false);
        chxFIFS.setEnabled(false);
        chxRR.setEnabled(false);
        chxSJF.setEnabled(false);
        añadirProcesosDesdeTabla();
        volcarProcesosEnCola();
        algoritmo = new FIFS(procesos, tablaProcesos, graficaPanel, graficaBuffer, bufferPanelGantt);
    }//GEN-LAST:event_btnListoActionPerformed

    private void chxFIFSMousePressed(java.awt.event.MouseEvent evt)//GEN-FIRST:event_chxFIFSMousePressed
    {//GEN-HEADEREND:event_chxFIFSMousePressed
        chxRR.setSelected(false);
        chxSJF.setSelected(false);
    }//GEN-LAST:event_chxFIFSMousePressed

    private void chxSJFMousePressed(java.awt.event.MouseEvent evt)//GEN-FIRST:event_chxSJFMousePressed
    {//GEN-HEADEREND:event_chxSJFMousePressed
        chxFIFS.setSelected(false);
        chxRR.setSelected(false);
    }//GEN-LAST:event_chxSJFMousePressed

    private void chxRRMousePressed(java.awt.event.MouseEvent evt)//GEN-FIRST:event_chxRRMousePressed
    {//GEN-HEADEREND:event_chxRRMousePressed
        chxFIFS.setSelected(false);
        chxSJF.setSelected(false);
    }//GEN-LAST:event_chxRRMousePressed

    private void panelGanttComponentAdded(java.awt.event.ContainerEvent evt)//GEN-FIRST:event_panelGanttComponentAdded
    {//GEN-HEADEREND:event_panelGanttComponentAdded
              this.prepararDiagramaGantt();
    }//GEN-LAST:event_panelGanttComponentAdded

    private void panelGanttComponentShown(java.awt.event.ComponentEvent evt)//GEN-FIRST:event_panelGanttComponentShown
    {//GEN-HEADEREND:event_panelGanttComponentShown
              this.prepararDiagramaGantt();
    }//GEN-LAST:event_panelGanttComponentShown

    /**
     * @param args the command line arguments
     */
    public static void main(String args[])
    {
        /* Set the Nimbus look and feel */
        //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
        /* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
         * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
         */
        try
        {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels())
            {
                if ("Nimbus".equals(info.getName()))
                {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ClassNotFoundException ex)
        {
            java.util.logging.Logger.getLogger(VentanaPrincipal.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (InstantiationException ex)
        {
            java.util.logging.Logger.getLogger(VentanaPrincipal.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (IllegalAccessException ex)
        {
            java.util.logging.Logger.getLogger(VentanaPrincipal.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (javax.swing.UnsupportedLookAndFeelException ex)
        {
            java.util.logging.Logger.getLogger(VentanaPrincipal.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }
        //</editor-fold>

        /* Create and display the form */
        java.awt.EventQueue.invokeLater(new Runnable()
        {
            @Override
            public void run()
            {
                new VentanaPrincipal().setVisible(true);
            }
        });
        
        
    }

    private void añadirProcesosDesdeTabla()
    {
        for (int i = 0; i < tablaProcesos.getRowCount(); i++)
        {
            procesos.add(new Proceso((int) tablaProcesos.getValueAt(i, 0),
                    (int) tablaProcesos.getValueAt(i, 1),
                    (int) tablaProcesos.getValueAt(i, 2),
                    (int) tablaProcesos.getValueAt(i, 3),
                    (int) tablaProcesos.getValueAt(i, 4),
                    (int) tablaProcesos.getValueAt(i, 5),
                    null));
        }
    }

    private void volcarProcesosEnCola()
    {
        Iterator iterador = procesos.iterator();
        int i = 1;
        while (iterador.hasNext())
        {
            Proceso current = (Proceso) iterador.next();
            modelCola.addRow(new Object[]
            {
                i, current.id, current.prioridad, "1"
            });
            i++;
        }
    }

    private void prepararDiagramaGantt()
    {
        int factorX = panelGantt.getHeight() / 6;
        int factorY = panelGantt.getWidth() / 50;

        for (int i = 0; i < 7; i++)
        {
            graficaBuffer.drawLine(0, factorX * i, panelGantt.getWidth(), factorX * i);
        }

        graficaBuffer.drawLine(0, panelGantt.getHeight() - 1, panelGantt.getWidth(), panelGantt.getHeight() - 1);

        for (int i = 0; i < 51; i++)
        {
            graficaBuffer.drawLine(factorY * i + 40, 0, factorY * i + 40, panelGantt.getHeight());

        }

        graficaBuffer.drawLine(0, 0, 0, panelGantt.getHeight());

        for (int i = 0; i < 50; i++)
        {
            graficaBuffer.drawString((i / 10) + "", 46 + (factorY * i), 17);
            graficaBuffer.drawString((i % 10) + "", 46 + (factorY * i), 34);
        }

        graficaBuffer.drawLine(panelGantt.getWidth() - 1, 0, panelGantt.getWidth() - 1, panelGantt.getHeight());
        
        
        graficaBuffer.drawLine(0, 0, 40, 40);
        
        graficaPanel.drawImage(bufferPanelGantt, 0, 0, null);
    }
    
    public BufferedImage copiarBuffer(BufferedImage buffer)
    {
        ColorModel cm = buffer.getColorModel();
        boolean isAlphaPremultiplied = cm.isAlphaPremultiplied();
        WritableRaster raster = buffer.copyData(null);
        return new BufferedImage(cm, raster, isAlphaPremultiplied, null);
    }


    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton btnAniadirProceso;
    private javax.swing.JButton btnListo;
    private javax.swing.JButton btnPasoSiguiente;
    private javax.swing.JButton btnSimular;
    private javax.swing.JCheckBox chxFIFS;
    private javax.swing.JCheckBox chxRR;
    private javax.swing.JCheckBox chxSJF;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JScrollPane jScrollPane2;
    private javax.swing.JScrollPane jScrollPane3;
    private javax.swing.JTable jTable1;
    private javax.swing.JTable jTable2;
    private javax.swing.JPanel panelGantt;
    private javax.swing.JScrollPane spColaProcesosListos;
    private javax.swing.JTable tablaProcesos;
    private javax.swing.JTable tblColaProcesosListos;
    // End of variables declaration//GEN-END:variables
}
